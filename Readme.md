Readme
================
Nidia Barco Armengol

# Introduction

The Deconvolution package contains different functions, specific to
generate absolute or relative deconvolution plots, with different
methods, which also return data frames with the result of the
deconvolution, or a list with data frames in the case of the deconv
function, these df can then be used with another function of the
package, the Box\_Deconv function to generate a boxplot that compares
two conditions in the different cell types, and does so from the df
resulting from the deconvolution.

# Methods

| Deconvolution method                                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CIBERSORT                                                      | Versatile computational method for quantifying cell fractions from bulk tissue gene expression profiles (GEPs). Combining support vector regression with prior knowledge of expression profiles from purified leukocyte subsets,this methode can accurately estimate the immune composition of a tumor biopsy.                                                                                                                                      |
| EPIC (Estimating the Proportions of Immune and Cancer cells)   | includes RNA-seq-based gene expression reference profiles from immune cells and other nonmalignant cell types found in tumors, can additionally manage user-defined gene expression reference profiles, include the ability to account for an uncharacterized cell type.                                                                                                                                                                            |
| FARDEEP (Fast And Robust DEconvolution of Expression Profiles) | This methode enumerate immune cell subsets from whole tumor tissue samples. To reduce noise in the tumor gene expression datasets, utilizes an adaptive least trimmed square to automatically detect and remove outliers before estimating the cell compositions. We show that FARDEEP is less susceptible to outliers and returns a better estimation of coefficients than the existing methods with both numerical simulations and real datasets. |

# Signature matrix

| Signature matrix                  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| LM22                              | Is a signature matrix file consisting of 547 genes that accurately distinguish 22 mature human hematopoietic populations isolated from peripheral blood or in vitro culture conditions, including seven T cell types, naïve and memory B cells, plasma cells, NK cells, and myeloid subsets.                                                                                                                                                                                                                |
| Monaco-ABIS\_Immune11\_Microarray | This matrix was constructed from a set of predictor variables (cell types), normalized by mRNA abundance with scaling factors, and filtered by extracting genes with very high or very low expression and also genes not expressed with the STAR method, including eleven cell tipes, T.Naive, T.Memory, B.Naive, B.Memory, Plasmablasts, NK, pDCs, Neutrophils.LD, Basophils.LD, mDCs, Monocytes.                                                                                                          |
| Wang2020\_signature.matrix        | To construct the signature matrix of brain data, adult scRNA-seq data from Darmanis et al. (2015) were analyzed by grouping characterized human brain cells into seven cell types \[astrocytes, endothelia, microglia, oligodendrocytes (Oligo), oligodendrocyte precursor cells (OPCs), inhibitory and excitatory neurons\] and selecting the top 50 marker genes for each cell type using SC3 (Kiselev et al., 2017). Finally, the expression of each marker gene in cells of the same type was averaged. |

# Functions

| Function           | Description                                                                                                                                                                                             | Return                                    |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
| CIBERSORT\_abs\_F  | Function that generates the absolute deconvolution plot with the CIBERSORT method, with the fractional plot, and returns a df resulting from the deconvolution.                                         | Deconvolution Graphs and Deconvolution df |
| CIBERSORT\_abs\_NF | Function that generates the absolute deconvolution plot with the CIBERSORT method, with the non-fractional plot, and returns a df resulting from the deconvolution.                                     | Deconvolution Graph and df                |
| CIBERSORT\_rel\_F  | Function that generates the relative deconvolution plot with the CIBERSORT method, with the fractional plot, and returns a df resulting from the deconvolution.                                         | Deconvolution Graphs and Deconvolution df |
| CIBERSORT\_rel\_NF | Function that generates the relative deconvolution plot with the CIBERSORT method, with the non-fractional plot, and returns a df resulting from the deconvolution.                                     | Deconvolution Graph and df                |
| EPIC\_rel\_F       | Function that generates the relative deconvolution plot with the EPIC method, with the fractional plot, and returns a df resulting from the deconvolution.                                              | Deconvolution Graphs and Deconvolution df |
| EPIC\_rel\_NF      | Function that generates the relative deconvolution plot with the EPIC method, with the non-fractional plot, and returns a df resulting from the deconvolution.                                          | Deconvolution Graph and df                |
| FARDEEP\_abs\_F    | Function that generates the absolute deconvolution plot with the FARDEEP method, with the fractional plot, and returns a df resulting from the deconvolution.                                           | Deconvolution Graphs and Deconvolution df |
| FARDEEP\_abs\_NF   | Function that generates the absolute deconvolution plot with the FARDEEP method, with the non-fractional plot, and returns a df resulting from the deconvolution.                                       | Deconvolution Graph and df                |
| FARDEEP\_rel\_F    | Function that generates the relative deconvolution plot with the FARDEEP method, with the fractional plot, and returns a df resulting from the deconvolution.                                           | Deconvolution Graphs and Deconvolution df |
| FARDEEP\_rel\_NF   | Function that generates the relative deconvolution plot with the FARDEEP method, with the non-fractional plot, and returns a df resulting from the deconvolution.                                       | Deconvolution Graph and df                |
| Deconv             | Function that generates massive deconvolution plots with the CIBERSORT, EPIC and FARDEEP methods, and returns a list of df’s resulting from the deconvolutions.                                         | Deconvolution Graphs and df’s list        |
| Box\_Deconv        | Function that generates a boxplot comparing conditions for each cell type from a df and a condition vector, and in the case of more than two conditions, it also returns a df with P.Value information. | Deconvolution Boxplot                     |

# Installation

``` r
library(devtools)
devtools::install_github("margenomics/Deconvolution")
library(Deconvolution)
```

# Usage

``` r
# CIBERSORT_abs_F
  C_abs <- CIBERSORT_abs_F("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", f, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name, "MONACO")

# CIBERSORT_abs_NF
  C_abs <- CIBERSORT_abs_NF("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# CIBERSORT_rel_F
  C_rel <- CIBERSORT_rel_F("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", f, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# CIBERSORT_rel_NF
  C_rel <- CIBERSORT_rel_NF("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# EPIC_rel_F
  E_rel <- EPIC_rel_F("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", f, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# EPIC_rel_NF
  E_rel <- EPIC_rel_NF("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# FARDEEP_abs_F
  F_abs <- FARDEEP_abs_F("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", f, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# FARDEEP_abs_NF
  F_abs <- FARDEEP_abs_NF("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# FARDEEP_rel_F
  F_rel <- FARDEEP_rel_F("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", f, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# FARDEEP_rel_NF
  F_rel <- FARDEEP_rel_NF("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# Deconv
  L_rel <- deconv("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", "ALL", "rel", fraccionate.samples=TRUE, fractions= f, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")

# Box_deconv
  P.value_df <- Box_Deconv(data= C_abs, cond= fractions, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", f_name= "Box_CIBERSORT_abs")
```

# Examples

``` r
matrix <- "Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt"
sig.matrix <- "Monaco-ABIS_Immune11_Microarray.txt"
fractions <- c(rep("A", each=18), rep("B", each=43), rep("C", each=36))
results_dir <- "/bicoh/nidia/Deconv/Brain_MMartin/test"
```

## CIBERSORT\_abs\_NF

### Itroduce:

``` r
C_abs <- CIBERSORT_abs_NF("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test")
```

### Return:

![Image
text](Images/CIBERSORT.abs_Wang2020_signature.matrix__plot.png)

``` r
# Show the first 6 columns of the deconvolution df.
knitr::kable(C_abs[,1:6 ])
```

|             | Microgl.f.1\_PAG | Microgl.f.P1\_SC | Microgl.f.P1\_SS | Microgl.f.13\_PAG | Microgl.f.P13\_SC | Microgl.f.P13\_SS |
|:------------|-----------------:|-----------------:|-----------------:|------------------:|------------------:|------------------:|
| Astrocyte   |        0.0095227 |        0.0090841 |        0.0041076 |         0.0177518 |         0.0100331 |         0.0034658 |
| Endothelial |        0.0049448 |        0.0034026 |        0.0019898 |         0.0022893 |         0.0081100 |         0.0010536 |
| Microglia   |        0.0000000 |        0.0026684 |        0.0000000 |         0.0000000 |         0.0006046 |         0.0000000 |
| Excitatory  |        0.0068483 |        0.0050919 |        0.0145409 |         0.0103304 |         0.0099650 |         0.0187261 |
| Inhibitory  |        0.0125782 |        0.0040904 |        0.0000000 |         0.0192275 |         0.0009906 |         0.0000000 |
| Oligo       |        0.0071585 |        0.0127354 |        0.0020316 |         0.0091130 |         0.0124069 |         0.0000000 |

## CIBERSORT\_rel\_F

### Itroduce:

``` r
C_rel <- CIBERSORT_rel_F("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", f, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test", height= 8, name= "MONACO")
```

### Return:

![Image text](/Images/C_rel_fractions.png)

``` r
# Show the first 6 columns of the deconvolution df.
knitr::kable(C_rel[,1:6 ])
```

|             | Microgl.f.1\_PAG | Microgl.f.P1\_SC | Microgl.f.P1\_SS | Microgl.f.13\_PAG | Microgl.f.P13\_SC | Microgl.f.P13\_SS |
|:------------|-----------------:|-----------------:|-----------------:|------------------:|------------------:|------------------:|
| Astrocyte   |        0.2319633 |        0.2450339 |        0.1811911 |         0.3023533 |         0.2382573 |         0.1490946 |
| Endothelial |        0.1204505 |        0.0917826 |        0.0877717 |         0.0389926 |         0.1925898 |         0.0453257 |
| Microglia   |        0.0000000 |        0.0719781 |        0.0000000 |         0.0000000 |         0.0143573 |         0.0000000 |
| Excitatory  |        0.1668184 |        0.1373495 |        0.6414209 |         0.1759511 |         0.2366410 |         0.8055797 |
| Inhibitory  |        0.3063941 |        0.1103333 |        0.0000000 |         0.3274878 |         0.0235249 |         0.0000000 |

## Deconv

### Introduce

``` r
L_rel <- deconv("Counts.HUMAN_nodup_Sal_Veh_IPs_INPUTs.txt", "Monaco-ABIS_Immune11_Microarray.txt", "ALL", "rel", fraccionate.samples=FALSE, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test")
```

### Return

![Image text](/Images/Ex_Deconv.png)

``` r
# l_df <- list(C_rel, E_rel, F_rel)
knitr::kable(l_df)
```

<table class="kable_wrapper">
<tbody>
<tr>
<td>

|             | Microgl.f.1\_PAG | Microgl.f.P1\_SC | Microgl.f.P1\_SS | Microgl.f.13\_PAG | Microgl.f.P13\_SC | Microgl.f.P13\_SS | Microgl.f.14\_PAG | Microgl.f.P14\_SC | Microgl.f.P14\_SS | Microgl.f.P15\_SC | Microgl.f.P15\_SS | Microgl.f.P2\_SC | Microgl.f.P2\_SS | Microgl.f.3\_PAG | Microgl.f.P3\_SC | Microgl.f.P3\_SS | Microgl.f.A\_PAG | Microgl.f.E\_PAG | Astrocytes.m.13\_PAG | Astrocytes.m.13\_SC | Astrocytes.m.13\_SS | Astrocytes.m.14\_PAG | Astrocytes.m.14\_SC | Astrocytes.m.14\_SS | Astrocytes.m.15\_PAG | Astrocytes.m.15\_SC | Astrocytes.m.15\_SS | Astrocytes.m.1\_PAG | Astrocytes.m.1\_SC | Astrocytes.m.1\_SS | Astrocytes.m.2\_PAG | Astrocytes.m.2\_SC | Astrocytes.m.2\_SS | Astrocytes.m.3\_PAG | Astrocytes.m.3\_SC | Astrocytes.m.3\_SS | Astrocytes.f.13\_PAG | Astrocytes.f.13\_SC | Astrocytes.f.13\_SS | Astrocytes.f.14\_PAG | Astrocytes.f.14\_SC | Astrocytes.f.14\_SS | Astrocytes.f.15\_PAG | Astrocytes.f.15\_SC | Astrocytes.f.15\_SS | Astrocytes.f.1\_PAG | Astrocytes.f.1\_SC | Astrocytes.f.1\_SS | Astrocytes.f.2\_PAG | Astrocytes.f.2\_SC | Astrocytes.f.2\_SS | Astrocytes.f.3\_PAG | Astrocytes.f.3\_SC | Astrocytes.f.3\_SS | Inputs.13\_SCa | Inputs.13\_SCb | Inputs.13\_SCc | Inputs.13\_SSa | Inputs.13\_SSb | Inputs.13\_SSc | Inputs.14\_SCa | Inputs.14\_SCb | Inputs.14\_SCc | Inputs.14\_SSa | Inputs.14\_SSb | Inputs.14\_SSc | Inputs.15\_SCa | Inputs.15\_SCb | Inputs.15\_SCc | Inputs.15\_SSa | Inputs.15\_SSb | Inputs.15\_SSc | Inputs.1\_PAGa | Inputs.1\_PAGb | Inputs.1\_PAGc | Inputs.1\_SCa | Inputs.1\_SCb | Inputs.1\_SCc | Inputs.1\_SSa | Inputs.1\_SSb | Inputs.1\_SSc | Inputs.2\_PAGa | Inputs.2\_PAGb | Inputs.2\_SCa | Inputs.2\_SCb | Inputs.2\_SCc | Inputs.2\_SSa | Inputs.2\_SSb | Inputs.2\_SSc | Inputs.3\_PAGa | Inputs.3\_PAGc | Inputs.3\_SCa | Inputs.3\_SCb | Inputs.3\_SCc | Inputs.3\_SSa | Inputs.3\_SSb | Inputs.3\_SSc | cell\_type  |
|:------------|-----------------:|-----------------:|-----------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|:------------|
| Astrocyte   |        0.2319633 |        0.2450339 |        0.1811911 |         0.3023533 |         0.2382573 |         0.1490946 |         0.3048079 |         0.1961500 |         0.1334172 |         0.1876719 |         0.1327476 |        0.2511737 |         0.953612 |        0.2832758 |        0.2625755 |        0.1206851 |        0.9375994 |        0.2488389 |            0.9816848 |           0.9212330 |           0.9781155 |            0.9808306 |           0.9268868 |            0.982685 |            0.9708503 |           0.9052436 |           0.9764197 |           0.9727306 |          0.9216817 |          0.9570979 |           0.9658629 |          0.9433222 |           0.966066 |           0.9793556 |          0.9430243 |          0.9472642 |             0.973782 |           0.9261576 |           0.9729366 |            0.9668088 |           0.9152206 |           0.9780707 |            0.9565715 |           0.9049762 |           0.9459767 |            0.978986 |          0.9282087 |          0.9710218 |           0.9785869 |          0.9205491 |          0.9734707 |           0.9812856 |          0.9285981 |          0.9665285 |      0.2778638 |      0.2642820 |      0.2800583 |      0.1301329 |      0.1287039 |      0.1167582 |      0.2585793 |      0.2798431 |      0.2691580 |      0.1271054 |      0.1421091 |      0.1054359 |      0.2708919 |      0.2662133 |      0.2952316 |      0.1360208 |      0.1436645 |      0.1285200 |      0.2056670 |      0.2032982 |      0.1863673 |     0.2825595 |     0.2593773 |     0.2692258 |     0.1253939 |     0.1153609 |     0.1377269 |      0.1973173 |      0.2154591 |     0.2681671 |     0.2683434 |     0.2534623 |     0.1193423 |     0.1349696 |     0.1132717 |      0.2078585 |      0.1871385 |     0.2506446 |     0.2608749 |     0.2544135 |     0.1142995 |     0.1307918 |     0.1387526 | Astrocyte   |
| Endothelial |        0.1204505 |        0.0917826 |        0.0877717 |         0.0389926 |         0.1925898 |         0.0453257 |         0.0547525 |         0.1879933 |         0.1165762 |         0.1129298 |         0.0250597 |        0.2032045 |         0.000000 |        0.0780074 |        0.1436780 |        0.0000000 |        0.0000000 |        0.1447696 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |            0.000000 |            0.0000000 |           0.0000000 |           0.0000000 |           0.0000000 |          0.0108277 |          0.0000000 |           0.0000000 |          0.0000000 |           0.000000 |           0.0000000 |          0.0000000 |          0.0000000 |             0.000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0023214 |           0.0000000 |            0.000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |      0.0272001 |      0.0283587 |      0.0176297 |      0.0036099 |      0.0120638 |      0.0104062 |      0.0096754 |      0.0109622 |      0.0208844 |      0.0072034 |      0.0087185 |      0.0201545 |      0.0227811 |      0.0224336 |      0.0140320 |      0.0112665 |      0.0042911 |      0.0039746 |      0.0006964 |      0.0054194 |      0.0000000 |     0.0203454 |     0.0185843 |     0.0115760 |     0.0152900 |     0.0181946 |     0.0080921 |      0.0044796 |      0.0017269 |     0.0175813 |     0.0165450 |     0.0193600 |     0.0181375 |     0.0024726 |     0.0036005 |      0.0097164 |      0.0000000 |     0.0170994 |     0.0155419 |     0.0106139 |     0.0157039 |     0.0159996 |     0.0110511 | Endothelial |
| Microglia   |        0.0000000 |        0.0719781 |        0.0000000 |         0.0000000 |         0.0143573 |         0.0000000 |         0.0000000 |         0.0649202 |         0.0375975 |         0.0871872 |         0.0146553 |        0.0222349 |         0.000000 |        0.0244612 |        0.0267628 |        0.1228543 |        0.0000000 |        0.0359352 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |            0.000000 |            0.0000000 |           0.0000000 |           0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |           0.000000 |           0.0000000 |          0.0000000 |          0.0000000 |             0.000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |            0.000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |      0.0000000 |      0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |      0.0000000 |      0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 | Microglia   |
| Excitatory  |        0.1668184 |        0.1373495 |        0.6414209 |         0.1759511 |         0.2366410 |         0.8055797 |         0.3362147 |         0.2154466 |         0.6685714 |         0.2240338 |         0.7270939 |        0.1644491 |         0.046388 |        0.1169492 |        0.1088798 |        0.5593451 |        0.0319084 |        0.3418913 |            0.0023651 |           0.0114412 |           0.0218845 |            0.0036205 |           0.0189512 |            0.017315 |            0.0072352 |           0.0141783 |           0.0235803 |           0.0068989 |          0.0000000 |          0.0429021 |           0.0000000 |          0.0000000 |           0.033934 |           0.0049230 |          0.0000000 |          0.0393513 |             0.002436 |           0.0000000 |           0.0270634 |            0.0000000 |           0.0000000 |           0.0216662 |            0.0000000 |           0.0000000 |           0.0527668 |            0.000000 |          0.0000000 |          0.0289782 |           0.0000000 |          0.0000000 |          0.0265293 |           0.0000000 |          0.0000000 |          0.0207995 |      0.2202867 |      0.2263430 |      0.2395696 |      0.8195606 |      0.8194159 |      0.8252623 |      0.2551064 |      0.2531747 |      0.2448072 |      0.8282819 |      0.8142657 |      0.7970720 |      0.2197370 |      0.2414416 |      0.2503821 |      0.8156638 |      0.8189526 |      0.7997923 |      0.2157131 |      0.2304472 |      0.2515077 |     0.2320731 |     0.2557615 |     0.2446890 |     0.7764594 |     0.7869590 |     0.8063853 |      0.1618519 |      0.2044234 |     0.2381970 |     0.2545957 |     0.2512235 |     0.7801322 |     0.8091963 |     0.8257342 |      0.3167554 |      0.2619469 |     0.2650026 |     0.2379589 |     0.2576481 |     0.7898106 |     0.7695345 |     0.8111605 | Excitatory  |
| Inhibitory  |        0.3063941 |        0.1103333 |        0.0000000 |         0.3274878 |         0.0235249 |         0.0000000 |         0.1499294 |         0.0313156 |         0.0000000 |         0.0399374 |         0.0000000 |        0.0651049 |         0.000000 |        0.2629700 |        0.1093251 |        0.0000000 |        0.0000000 |        0.0152817 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |            0.000000 |            0.0000000 |           0.0000000 |           0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |           0.000000 |           0.0000000 |          0.0000000 |          0.0000000 |             0.000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0196385 |           0.0000000 |           0.0000000 |            0.000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |      0.1797065 |      0.1991778 |      0.1826198 |      0.0000000 |      0.0000000 |      0.0000000 |      0.1902904 |      0.2011320 |      0.1800970 |      0.0000000 |      0.0000000 |      0.0000000 |      0.1901824 |      0.1728150 |      0.1496816 |      0.0000000 |      0.0000000 |      0.0000000 |      0.4276433 |      0.3948722 |      0.3781526 |     0.1651036 |     0.1753580 |     0.2102887 |     0.0000000 |     0.0000000 |     0.0000000 |      0.4418221 |      0.4115939 |     0.2045464 |     0.1628189 |     0.1901772 |     0.0000000 |     0.0070968 |     0.0000000 |      0.3312234 |      0.3694456 |     0.2083312 |     0.2007658 |     0.2000297 |     0.0000000 |     0.0000000 |     0.0000000 | Inhibitory  |

</td>
<td>

|             | Microgl.f.1\_PAG | Microgl.f.P1\_SC | Microgl.f.P1\_SS | Microgl.f.13\_PAG | Microgl.f.P13\_SC | Microgl.f.P13\_SS | Microgl.f.14\_PAG | Microgl.f.P14\_SC | Microgl.f.P14\_SS | Microgl.f.P15\_SC | Microgl.f.P15\_SS | Microgl.f.P2\_SC | Microgl.f.P2\_SS | Microgl.f.3\_PAG | Microgl.f.P3\_SC | Microgl.f.P3\_SS | Microgl.f.A\_PAG | Microgl.f.E\_PAG | Astrocytes.m.13\_PAG | Astrocytes.m.13\_SC | Astrocytes.m.13\_SS | Astrocytes.m.14\_PAG | Astrocytes.m.14\_SC | Astrocytes.m.14\_SS | Astrocytes.m.15\_PAG | Astrocytes.m.15\_SC | Astrocytes.m.15\_SS | Astrocytes.m.1\_PAG | Astrocytes.m.1\_SC | Astrocytes.m.1\_SS | Astrocytes.m.2\_PAG | Astrocytes.m.2\_SC | Astrocytes.m.2\_SS | Astrocytes.m.3\_PAG | Astrocytes.m.3\_SC | Astrocytes.m.3\_SS | Astrocytes.f.13\_PAG | Astrocytes.f.13\_SC | Astrocytes.f.13\_SS | Astrocytes.f.14\_PAG | Astrocytes.f.14\_SC | Astrocytes.f.14\_SS | Astrocytes.f.15\_PAG | Astrocytes.f.15\_SC | Astrocytes.f.15\_SS | Astrocytes.f.1\_PAG | Astrocytes.f.1\_SC | Astrocytes.f.1\_SS | Astrocytes.f.2\_PAG | Astrocytes.f.2\_SC | Astrocytes.f.2\_SS | Astrocytes.f.3\_PAG | Astrocytes.f.3\_SC | Astrocytes.f.3\_SS | Inputs.13\_SCa | Inputs.13\_SCb | Inputs.13\_SCc | Inputs.13\_SSa | Inputs.13\_SSb | Inputs.13\_SSc | Inputs.14\_SCa | Inputs.14\_SCb | Inputs.14\_SCc | Inputs.14\_SSa | Inputs.14\_SSb | Inputs.14\_SSc | Inputs.15\_SCa | Inputs.15\_SCb | Inputs.15\_SCc | Inputs.15\_SSa | Inputs.15\_SSb | Inputs.15\_SSc | Inputs.1\_PAGa | Inputs.1\_PAGb | Inputs.1\_PAGc | Inputs.1\_SCa | Inputs.1\_SCb | Inputs.1\_SCc | Inputs.1\_SSa | Inputs.1\_SSb | Inputs.1\_SSc | Inputs.2\_PAGa | Inputs.2\_PAGb | Inputs.2\_SCa | Inputs.2\_SCb | Inputs.2\_SCc | Inputs.2\_SSa | Inputs.2\_SSb | Inputs.2\_SSc | Inputs.3\_PAGa | Inputs.3\_PAGc | Inputs.3\_SCa | Inputs.3\_SCb | Inputs.3\_SCc | Inputs.3\_SSa | Inputs.3\_SSb | Inputs.3\_SSc | cell\_type  |
|:------------|-----------------:|-----------------:|-----------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|:------------|
| Astrocyte   |        0.1531795 |        0.1556428 |        0.2864268 |         0.2318391 |         0.2240954 |         0.1569012 |         0.2229195 |         0.0343118 |         0.1510058 |         0.0308699 |         0.2229778 |        0.1383806 |        0.9999807 |        0.0981516 |        0.2240959 |        0.1517206 |        0.9999895 |        0.1434801 |            0.9999959 |           0.9999983 |           0.9982896 |            0.9997756 |           0.9820319 |           0.9984242 |            0.9995360 |           0.9999992 |           0.9584540 |           0.9999934 |          0.9708628 |          0.9998423 |           0.9985381 |          0.9998962 |          0.9919912 |           0.9998031 |          0.9999971 |          0.9999913 |            0.9999915 |           0.9999916 |           0.9999443 |            0.8427025 |           0.9999975 |           0.9812662 |            0.9999131 |           0.9987392 |           0.9999605 |           0.9996732 |          0.9999969 |          0.9980060 |           0.9997829 |          0.9984416 |          0.9970148 |           0.9999935 |          0.9863500 |          0.9989152 |      0.1772088 |      0.0000678 |      0.0000037 |      0.7304058 |      0.8127525 |      0.6528755 |      0.0283409 |      0.0010658 |      0.1755433 |      0.6922065 |      0.6510936 |      0.5455843 |      0.0000089 |      0.0000000 |      0.0011019 |      0.6294816 |      0.2897004 |      0.5119853 |      0.3560652 |      0.2447115 |      0.2173367 |     0.0001157 |     0.0317532 |     0.0537580 |     0.5935820 |     0.7042979 |     0.6812051 |      0.1908975 |      0.3817485 |     0.0134011 |     0.0000009 |     0.0000001 |     0.5865350 |     0.5017381 |     0.6006538 |      0.2307697 |      0.1118483 |     0.0000052 |     0.0000014 |     0.0003433 |     0.6950378 |     0.6309812 |     0.6947078 | Astrocyte   |
| Endothelial |        0.4571354 |        0.1533534 |        0.4320599 |         0.4302060 |         0.2527313 |         0.5786744 |         0.4200228 |         0.2514160 |         0.5762569 |         0.2961683 |         0.5224139 |        0.0600380 |        0.0000079 |        0.4992898 |        0.2527312 |        0.5637528 |        0.0000001 |        0.3468783 |            0.0000017 |           0.0000005 |           0.0001217 |            0.0000109 |           0.0000002 |           0.0000040 |            0.0000000 |           0.0000001 |           0.0000002 |           0.0000002 |          0.0022966 |          0.0000000 |           0.0000001 |          0.0001034 |          0.0000000 |           0.0000007 |          0.0000001 |          0.0000033 |            0.0000001 |           0.0000000 |           0.0000131 |            0.0004746 |           0.0000001 |           0.0016511 |            0.0000001 |           0.0000007 |           0.0000004 |           0.0000002 |          0.0000001 |          0.0015637 |           0.0001282 |          0.0000025 |          0.0016644 |           0.0000001 |          0.0016738 |          0.0001963 |      0.0165489 |      0.0005637 |      0.0008183 |      0.0000003 |      0.0000041 |      0.0005342 |      0.0015694 |      0.0000016 |      0.0177722 |      0.0058625 |      0.0000191 |      0.0000001 |      0.0001266 |      0.0000040 |      0.0017098 |      0.0000001 |      0.0660405 |      0.0000508 |      0.0000038 |      0.0149465 |      0.0000005 |     0.0000001 |     0.0000000 |     0.0001708 |     0.0003122 |     0.0000031 |     0.0000707 |      0.0018734 |      0.0005194 |     0.0015526 |     0.0000064 |     0.0000000 |     0.0000000 |     0.0000006 |     0.0189288 |      0.0000331 |      0.0000072 |     0.0000300 |     0.0003288 |     0.0000005 |     0.0042326 |     0.0000001 |     0.0001300 | Endothelial |
| Microglia   |        0.1682455 |        0.1790524 |        0.2390194 |         0.1229658 |         0.1476324 |         0.2542964 |         0.1246003 |         0.1950078 |         0.2727293 |         0.1049564 |         0.2406833 |        0.2912494 |        0.0000000 |        0.2339397 |        0.1476323 |        0.2727341 |        0.0000001 |        0.1561005 |            0.0000001 |           0.0000002 |           0.0000060 |            0.0001310 |           0.0090481 |           0.0004606 |            0.0000000 |           0.0000001 |           0.0000921 |           0.0000005 |          0.0061278 |          0.0000002 |           0.0009354 |          0.0000002 |          0.0002066 |           0.0001411 |          0.0000010 |          0.0000043 |            0.0000058 |           0.0000003 |           0.0000000 |            0.0000000 |           0.0000017 |           0.0091950 |            0.0000007 |           0.0004287 |           0.0000006 |           0.0000000 |          0.0000001 |          0.0000021 |           0.0000012 |          0.0012642 |          0.0000008 |           0.0000001 |          0.0000039 |          0.0000315 |      0.0001361 |      0.0000013 |      0.0000002 |      0.0000000 |      0.0010451 |      0.0000001 |      0.0000007 |      0.0009750 |      0.0000089 |      0.0000003 |      0.0133865 |      0.0000008 |      0.0000002 |      0.0000018 |      0.0000000 |      0.0004292 |      0.0018267 |      0.0003436 |      0.0000006 |      0.0000965 |      0.0000004 |     0.0000218 |     0.0000006 |     0.0001328 |     0.0266920 |     0.0000011 |     0.0005588 |      0.0000001 |      0.0000107 |     0.0007575 |     0.0001938 |     0.0000054 |     0.0000001 |     0.0401864 |     0.0091286 |      0.0000017 |      0.0000002 |     0.0000000 |     0.0000338 |     0.0000015 |     0.0000007 |     0.0000000 |     0.0000455 | Microglia   |
| Excitatory  |        0.0000460 |        0.0000004 |        0.0000008 |         0.0000013 |         0.0036760 |         0.0000029 |         0.0000047 |         0.0010129 |         0.0000013 |         0.0135458 |         0.0003086 |        0.0020982 |        0.0000003 |        0.0000001 |        0.0036759 |        0.0003012 |        0.0000081 |        0.0000018 |            0.0000002 |           0.0000000 |           0.0001698 |            0.0000006 |           0.0051129 |           0.0000331 |            0.0001226 |           0.0000000 |           0.0010561 |           0.0000033 |          0.0206927 |          0.0001572 |           0.0005255 |          0.0000000 |          0.0077220 |           0.0000506 |          0.0000015 |          0.0000010 |            0.0000014 |           0.0000037 |           0.0000002 |            0.0056193 |           0.0000001 |           0.0042175 |            0.0000019 |           0.0000008 |           0.0000000 |           0.0002171 |          0.0000002 |          0.0000034 |           0.0000408 |          0.0000001 |          0.0000001 |           0.0000048 |          0.0109603 |          0.0000249 |      0.0001210 |      0.0000069 |      0.0000000 |      0.0185635 |      0.0270424 |      0.2309204 |      0.0000282 |      0.0000001 |      0.0000068 |      0.1425867 |      0.1747445 |      0.1667523 |      0.0003334 |      0.0000001 |      0.0000004 |      0.2887906 |      0.3110674 |      0.1444270 |      0.0000000 |      0.0000004 |      0.0000001 |     0.0000000 |     0.1284937 |     0.0031046 |     0.0472345 |     0.0038344 |     0.0186686 |      0.0000000 |      0.0000132 |     0.0015034 |     0.0000000 |     0.0000038 |     0.0434436 |     0.1408797 |     0.1138630 |      0.0000280 |      0.0000194 |     0.0000001 |     0.0000019 |     0.0000002 |     0.0097233 |     0.0187571 |     0.1713779 | Excitatory  |
| Inhibitory  |        0.0000002 |        0.0000051 |        0.0165302 |         0.0044590 |         0.0765474 |         0.0054710 |         0.0003196 |         0.0000029 |         0.0000018 |         0.0000801 |         0.0002093 |        0.0021335 |        0.0000085 |        0.0000010 |        0.0765473 |        0.0002964 |        0.0000020 |        0.0000248 |            0.0000001 |           0.0000003 |           0.0009563 |            0.0000001 |           0.0000003 |           0.0002579 |            0.0000739 |           0.0000000 |           0.0178012 |           0.0000009 |          0.0000060 |          0.0000002 |           0.0000009 |          0.0000001 |          0.0000002 |           0.0000043 |          0.0000001 |          0.0000001 |            0.0000004 |           0.0000000 |           0.0000309 |            0.0042793 |           0.0000000 |           0.0036702 |            0.0000005 |           0.0000020 |           0.0000038 |           0.0000021 |          0.0000007 |          0.0004247 |           0.0000006 |          0.0000001 |          0.0000003 |           0.0000002 |          0.0006968 |          0.0008316 |      0.0001356 |      0.0000872 |      0.0009833 |      0.0008026 |      0.0035364 |      0.0000004 |      0.0004061 |      0.0000619 |      0.0000095 |      0.0000003 |      0.1319876 |      0.0000001 |      0.0000012 |      0.0000001 |      0.0000008 |      0.0000005 |      0.1213703 |      0.0000011 |      0.0000000 |      0.0000002 |      0.0000000 |     0.0000162 |     0.0082813 |     0.0162309 |     0.0003282 |     0.0000013 |     0.0005527 |      0.0057812 |      0.0220669 |     0.0000009 |     0.0000001 |     0.0000001 |     0.0097255 |     0.0000003 |     0.0000119 |      0.1126288 |      0.0000001 |     0.0006164 |     0.0000001 |     0.0002232 |     0.0000023 |     0.0001764 |     0.0021286 | Inhibitory  |
| Oligo       |        0.2213921 |        0.5119449 |        0.0259628 |         0.2105285 |         0.2953168 |         0.0046540 |         0.2321330 |         0.5182487 |         0.0000042 |         0.5543792 |         0.0134060 |        0.5056029 |        0.0000026 |        0.1686094 |        0.2953167 |        0.0110725 |        0.0000001 |        0.3535146 |            0.0000021 |           0.0000002 |           0.0004566 |            0.0000189 |           0.0038067 |           0.0008201 |            0.0002674 |           0.0000004 |           0.0225962 |           0.0000002 |          0.0000141 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000800 |           0.0000001 |          0.0000002 |          0.0000000 |            0.0000008 |           0.0000002 |           0.0000002 |            0.1469243 |           0.0000001 |           0.0000000 |            0.0000770 |           0.0008285 |           0.0000220 |           0.0001073 |          0.0000017 |          0.0000001 |           0.0000462 |          0.0002915 |          0.0013196 |           0.0000001 |          0.0000000 |          0.0000005 |      0.8057745 |      0.9992695 |      0.9981922 |      0.2502279 |      0.1556193 |      0.1156693 |      0.9696545 |      0.9978955 |      0.8066553 |      0.1593438 |      0.0287686 |      0.2876624 |      0.9995297 |      0.9999879 |      0.9971866 |      0.0812981 |      0.2097057 |      0.3431921 |      0.6439303 |      0.7402449 |      0.7826616 |     0.9998462 |     0.8314712 |     0.9265554 |     0.3318378 |     0.2918618 |     0.2989107 |      0.8014476 |      0.5956391 |     0.9827844 |     0.9997984 |     0.9999905 |     0.3602958 |     0.3171949 |     0.2574138 |      0.6565378 |      0.8881248 |     0.9993482 |     0.9996340 |     0.9994313 |     0.2910028 |     0.3500852 |     0.1316101 | Oligo       |
| otherCells  |        0.0000013 |        0.0000009 |        0.0000001 |         0.0000004 |         0.0000007 |         0.0000000 |         0.0000001 |         0.0000000 |         0.0000007 |         0.0000003 |         0.0000010 |        0.0004975 |        0.0000000 |        0.0000084 |        0.0000006 |        0.0001224 |        0.0000000 |        0.0000000 |            0.0000000 |           0.0000005 |           0.0000000 |            0.0000629 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000002 |           0.0000016 |          0.0000000 |          0.0000000 |           0.0000001 |          0.0000000 |          0.0000001 |           0.0000002 |          0.0000000 |          0.0000000 |            0.0000000 |           0.0000041 |           0.0000112 |            0.0000000 |           0.0000004 |           0.0000000 |            0.0000066 |           0.0000001 |           0.0000127 |           0.0000000 |          0.0000003 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000012 |          0.0003152 |          0.0000000 |      0.0000752 |      0.0000037 |      0.0000023 |      0.0000000 |      0.0000002 |      0.0000001 |      0.0000002 |      0.0000000 |      0.0000041 |      0.0000000 |      0.0000001 |      0.0000000 |      0.0000000 |      0.0000062 |      0.0000004 |      0.0000000 |      0.0002890 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000007 |     0.0000000 |     0.0000000 |     0.0000475 |     0.0000133 |     0.0000004 |     0.0000335 |      0.0000002 |      0.0000021 |     0.0000001 |     0.0000004 |     0.0000001 |     0.0000000 |     0.0000001 |     0.0000000 |      0.0000008 |      0.0000000 |     0.0000001 |     0.0000001 |     0.0000001 |     0.0000004 |     0.0000000 |     0.0000000 | otherCells  |

</td>
<td>

|             | Microgl.f.1\_PAG | Microgl.f.P1\_SC | Microgl.f.P1\_SS | Microgl.f.13\_PAG | Microgl.f.P13\_SC | Microgl.f.P13\_SS | Microgl.f.14\_PAG | Microgl.f.P14\_SC | Microgl.f.P14\_SS | Microgl.f.P15\_SC | Microgl.f.P15\_SS | Microgl.f.P2\_SC | Microgl.f.P2\_SS | Microgl.f.3\_PAG | Microgl.f.P3\_SC | Microgl.f.P3\_SS | Microgl.f.A\_PAG | Microgl.f.E\_PAG | Astrocytes.m.13\_PAG | Astrocytes.m.13\_SC | Astrocytes.m.13\_SS | Astrocytes.m.14\_PAG | Astrocytes.m.14\_SC | Astrocytes.m.14\_SS | Astrocytes.m.15\_PAG | Astrocytes.m.15\_SC | Astrocytes.m.15\_SS | Astrocytes.m.1\_PAG | Astrocytes.m.1\_SC | Astrocytes.m.1\_SS | Astrocytes.m.2\_PAG | Astrocytes.m.2\_SC | Astrocytes.m.2\_SS | Astrocytes.m.3\_PAG | Astrocytes.m.3\_SC | Astrocytes.m.3\_SS | Astrocytes.f.13\_PAG | Astrocytes.f.13\_SC | Astrocytes.f.13\_SS | Astrocytes.f.14\_PAG | Astrocytes.f.14\_SC | Astrocytes.f.14\_SS | Astrocytes.f.15\_PAG | Astrocytes.f.15\_SC | Astrocytes.f.15\_SS | Astrocytes.f.1\_PAG | Astrocytes.f.1\_SC | Astrocytes.f.1\_SS | Astrocytes.f.2\_PAG | Astrocytes.f.2\_SC | Astrocytes.f.2\_SS | Astrocytes.f.3\_PAG | Astrocytes.f.3\_SC | Astrocytes.f.3\_SS | Inputs.13\_SCa | Inputs.13\_SCb | Inputs.13\_SCc | Inputs.13\_SSa | Inputs.13\_SSb | Inputs.13\_SSc | Inputs.14\_SCa | Inputs.14\_SCb | Inputs.14\_SCc | Inputs.14\_SSa | Inputs.14\_SSb | Inputs.14\_SSc | Inputs.15\_SCa | Inputs.15\_SCb | Inputs.15\_SCc | Inputs.15\_SSa | Inputs.15\_SSb | Inputs.15\_SSc | Inputs.1\_PAGa | Inputs.1\_PAGb | Inputs.1\_PAGc | Inputs.1\_SCa | Inputs.1\_SCb | Inputs.1\_SCc | Inputs.1\_SSa | Inputs.1\_SSb | Inputs.1\_SSc | Inputs.2\_PAGa | Inputs.2\_PAGb | Inputs.2\_SCa | Inputs.2\_SCb | Inputs.2\_SCc | Inputs.2\_SSa | Inputs.2\_SSb | Inputs.2\_SSc | Inputs.3\_PAGa | Inputs.3\_PAGc | Inputs.3\_SCa | Inputs.3\_SCb | Inputs.3\_SCc | Inputs.3\_SSa | Inputs.3\_SSb | Inputs.3\_SSc | cell\_type  |
|:------------|-----------------:|-----------------:|-----------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|------------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|-----------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|--------------------:|-------------------:|-------------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|---------------:|---------------:|--------------:|--------------:|--------------:|--------------:|--------------:|--------------:|:------------|
| Astrocyte   |        0.3470971 |        0.4039560 |        0.2704517 |         0.3044236 |         0.3303557 |         0.2351979 |         0.2997251 |         0.4826630 |         0.2623596 |         0.3036369 |         0.2264845 |        0.3775865 |        0.9191657 |        0.4212110 |        0.3053200 |        0.2977232 |        0.9661732 |        0.3868156 |            0.9863988 |           0.9848992 |                   1 |            0.9695393 |           0.9879835 |                   1 |             0.977498 |           0.9738720 |            0.996246 |           0.9669049 |          0.9678565 |          0.9317405 |           0.9514707 |          0.9785110 |                  1 |           0.9621029 |          0.9874909 |          0.9789040 |            0.9695161 |           0.9906141 |           0.9681954 |            0.9439148 |           0.9924263 |           0.9707925 |            0.9728238 |           0.9533308 |           0.9650768 |           0.9596379 |          0.9707082 |                  1 |           0.9701451 |          0.9661143 |          0.9796739 |           0.9714842 |          0.9872680 |          0.9723524 |      0.2415390 |      0.2279620 |      0.2332723 |      0.1399826 |      0.1235768 |      0.1446324 |      0.2415345 |      0.2574274 |      0.2353020 |      0.1419834 |      0.1285592 |      0.1678010 |      0.2288922 |      0.2231777 |      0.2385877 |      0.0858250 |      0.0781199 |      0.0941811 |      0.1962444 |      0.2275231 |      0.2021321 |     0.2230245 |     0.2293605 |     0.2266717 |     0.2024022 |     0.1139714 |     0.1262360 |      0.1821823 |      0.2022890 |     0.2193501 |     0.2197570 |     0.2041347 |     0.1209310 |     0.1277896 |     0.1602690 |      0.2790096 |      0.1847427 |     0.2058117 |     0.2253962 |     0.2165901 |     0.1716139 |     0.1833745 |     0.1665730 | Astrocyte   |
| Endothelial |        0.0000000 |        0.0000000 |        0.0000000 |         0.0000000 |         0.0000000 |         0.0000000 |         0.0000000 |         0.0000000 |         0.0000000 |         0.0000000 |         0.0000000 |        0.0000000 |        0.0178202 |        0.0000000 |        0.0000000 |        0.0000000 |        0.0000000 |        0.0000000 |            0.0000000 |           0.0046012 |                   0 |            0.0025112 |           0.0000000 |                   0 |             0.000000 |           0.0017119 |            0.000000 |           0.0075782 |          0.0264450 |          0.0021333 |           0.0000000 |          0.0139494 |                  0 |           0.0157700 |          0.0125091 |          0.0000000 |            0.0026869 |           0.0015439 |           0.0000000 |            0.0055596 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0122935 |           0.0000000 |           0.0092530 |          0.0000000 |                  0 |           0.0058854 |          0.0000000 |          0.0000000 |           0.0097361 |          0.0000000 |          0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0254403 |      0.0218992 |      0.0398969 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0516803 |      0.0246844 |      0.0225976 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0088313 |      0.0065248 |      0.0110836 |      0.0000000 |      0.0173948 |      0.0107781 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0377121 |     0.0295466 |     0.0205340 |      0.0000000 |      0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0249475 |     0.0185289 |     0.0250449 |      0.0000000 |      0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0343206 |     0.0386388 |     0.0373372 | Endothelial |
| Microglia   |        0.0817858 |        0.1573647 |        0.0607674 |         0.0274723 |         0.3272161 |         0.0821891 |         0.0449151 |         0.1259090 |         0.1155359 |         0.3532067 |         0.0602150 |        0.1578132 |        0.0000000 |        0.1413216 |        0.2133711 |        0.0844130 |        0.0000000 |        0.0504709 |            0.0000000 |           0.0000000 |                   0 |            0.0000000 |           0.0000000 |                   0 |             0.000000 |           0.0000000 |            0.001211 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |                  0 |           0.0000000 |          0.0000000 |          0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |           0.0000000 |          0.0000000 |                  0 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |      0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |      0.0000000 |      0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |      0.0000000 |      0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 |     0.0000000 | Microglia   |
| Excitatory  |        0.2555004 |        0.2237835 |        0.5545924 |         0.3196995 |         0.1666687 |         0.6199324 |         0.3225239 |         0.1700182 |         0.4997764 |         0.1242656 |         0.5911468 |        0.2303796 |        0.0626031 |        0.1531847 |        0.2738822 |        0.3773622 |        0.0000000 |        0.4477479 |            0.0000000 |           0.0002633 |                   0 |            0.0000000 |           0.0002888 |                   0 |             0.000000 |           0.0104157 |            0.002543 |           0.0000000 |          0.0000000 |          0.0599161 |           0.0000000 |          0.0038549 |                  0 |           0.0000000 |          0.0000000 |          0.0096113 |            0.0000000 |           0.0000000 |           0.0295922 |            0.0000000 |           0.0000000 |           0.0283332 |            0.0000000 |           0.0215039 |           0.0334825 |           0.0000000 |          0.0131293 |                  0 |           0.0000000 |          0.0182416 |          0.0203261 |           0.0000000 |          0.0030664 |          0.0088429 |      0.2106863 |      0.2097597 |      0.2349192 |      0.6999981 |      0.8226434 |      0.7819159 |      0.2174077 |      0.2139375 |      0.2344721 |      0.7557264 |      0.8202013 |      0.7855850 |      0.2163492 |      0.2108427 |      0.2260894 |      0.7405705 |      0.7675442 |      0.8880409 |      0.2152611 |      0.3645369 |      0.3099331 |     0.2177781 |     0.2440726 |     0.2936128 |     0.7491605 |     0.6990149 |     0.7496171 |      0.1354123 |      0.2375535 |     0.2048867 |     0.2038170 |     0.2557407 |     0.8541215 |     0.7403491 |     0.6890254 |      0.3013819 |      0.2552639 |     0.2245624 |     0.2285544 |     0.2385747 |     0.7881588 |     0.7732407 |     0.7853303 | Excitatory  |
| Inhibitory  |        0.2350374 |        0.0774297 |        0.0000000 |         0.3088119 |         0.0351121 |         0.0000000 |         0.2798851 |         0.0000000 |         0.0000000 |         0.0533371 |         0.0000000 |        0.0887394 |        0.0000000 |        0.1906029 |        0.0000000 |        0.0000000 |        0.0000000 |        0.0000000 |            0.0000000 |           0.0000000 |                   0 |            0.0000000 |           0.0000000 |                   0 |             0.000000 |           0.0000000 |            0.000000 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |                  0 |           0.0000000 |          0.0000000 |          0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |            0.0000000 |           0.0000000 |           0.0000000 |           0.0000000 |          0.0000000 |                  0 |           0.0000000 |          0.0000000 |          0.0000000 |           0.0000000 |          0.0000000 |          0.0000000 |      0.1532352 |      0.1807515 |      0.1384002 |      0.0229850 |      0.0000000 |      0.0302653 |      0.1752896 |      0.1115197 |      0.1124385 |      0.0248368 |      0.0099715 |      0.0222201 |      0.1558017 |      0.1345614 |      0.0988677 |      0.1112122 |      0.1024235 |      0.0066944 |      0.4665660 |      0.2682966 |      0.3720114 |     0.1288578 |     0.1508667 |     0.1315403 |     0.0070763 |     0.0193209 |     0.0068525 |      0.5677738 |      0.3852955 |     0.1560890 |     0.1190434 |     0.1202000 |     0.0000000 |     0.0334556 |     0.0020573 |      0.3074269 |      0.4377261 |     0.1672079 |     0.1431959 |     0.1495448 |     0.0000000 |     0.0000000 |     0.0000000 | Inhibitory  |
| Oligo       |        0.0805793 |        0.1374661 |        0.1141886 |         0.0395927 |         0.1406473 |         0.0626806 |         0.0529508 |         0.2214099 |         0.1223281 |         0.1655537 |         0.1221537 |        0.1454813 |        0.0004110 |        0.0936797 |        0.2074267 |        0.2405016 |        0.0338268 |        0.1149656 |            0.0136012 |           0.0102364 |                   0 |            0.0279495 |           0.0117277 |                   0 |             0.022502 |           0.0140005 |            0.000000 |           0.0255169 |          0.0056985 |          0.0062100 |           0.0485293 |          0.0036846 |                  0 |           0.0221270 |          0.0000000 |          0.0114847 |            0.0277970 |           0.0078420 |           0.0022124 |            0.0505257 |           0.0075737 |           0.0008743 |            0.0271762 |           0.0128717 |           0.0014406 |           0.0311091 |          0.0161625 |                  0 |           0.0239694 |          0.0156441 |          0.0000000 |           0.0187797 |          0.0096656 |          0.0188047 |      0.3945394 |      0.3815268 |      0.3934083 |      0.1115941 |      0.0318806 |      0.0032895 |      0.3657682 |      0.4171154 |      0.4177874 |      0.0257730 |      0.0165837 |      0.0017963 |      0.3989568 |      0.4314182 |      0.4364552 |      0.0535611 |      0.0453876 |      0.0000000 |      0.1219285 |      0.1222486 |      0.1051452 |     0.4303397 |     0.3757003 |     0.3481751 |     0.0036489 |     0.1381462 |     0.0967605 |      0.1146316 |      0.1748620 |     0.4196743 |     0.4573826 |     0.4199245 |     0.0000000 |     0.0798769 |     0.1236034 |      0.1121816 |      0.1222673 |     0.4024179 |     0.4028535 |     0.3952904 |     0.0059067 |     0.0047460 |     0.0107595 | Oligo       |

</td>
</tr>
</tbody>
</table>

## Box\_Deconv

### Introduce

``` r
P.value_df <- Box_Deconv(data= C_abs, cond= fractions, results_dir = "/bicoh/nidia/Deconv/Brain_MMartin/test")
```

### Return

#### With 2 conditions

![Image text](/Images/2_cond_ex.png)

#### With more than 2 conditions

![Image text](/Images/3_cond_ex.png)

``` r
knitr::kable(anno_df)
```

| variable    | .y.   | group1 | group2 |         p |   p.adj | p.format   | p.signif | method |
|:------------|:------|:-------|:-------|----------:|--------:|:-----------|:---------|:-------|
| Astrocyte   | value | A      | B      | 0.0000000 | 0.0e+00 | 2.5e-12    | \*\*\*\* | T-test |
| Astrocyte   | value | A      | C      | 0.0010372 | 7.3e-03 | 0.0010     | \*\*     | T-test |
| Astrocyte   | value | B      | C      | 0.0000000 | 0.0e+00 | &lt; 2e-16 | \*\*\*\* | T-test |
| Endothelial | value | A      | B      | 0.1218155 | 2.4e-01 | 0.1218     | ns       | T-test |
| Endothelial | value | A      | C      | 0.0000079 | 7.9e-05 | 7.9e-06    | \*\*\*\* | T-test |
| Endothelial | value | B      | C      | 0.0000000 | 4.0e-07 | 3.3e-08    | \*\*\*\* | T-test |
| Microglia   | value | A      | B      | 0.0089715 | 4.5e-02 | 0.0090     | \*\*     | T-test |
| Microglia   | value | A      | C      | 0.0089715 | 4.5e-02 | 0.0090     | \*\*     | T-test |
| Excitatory  | value | A      | B      | 0.0662205 | 2.0e-01 | 0.0662     | ns       | T-test |
| Excitatory  | value | A      | C      | 0.0000000 | 4.0e-07 | 3.4e-08    | \*\*\*\* | T-test |
| Excitatory  | value | B      | C      | 0.0000041 | 4.5e-05 | 4.1e-06    | \*\*\*\* | T-test |
| Inhibitory  | value | A      | B      | 0.1927551 | 2.4e-01 | 0.1928     | ns       | T-test |
| Inhibitory  | value | A      | C      | 0.0000126 | 1.1e-04 | 1.3e-05    | \*\*\*\* | T-test |
| Inhibitory  | value | B      | C      | 0.0000436 | 3.5e-04 | 4.4e-05    | \*\*\*\* | T-test |
| Oligo       | value | A      | B      | 0.0013822 | 8.3e-03 | 0.0014     | \*\*     | T-test |
| Oligo       | value | A      | C      | 0.0000000 | 0.0e+00 | &lt; 2e-16 | \*\*\*\* | T-test |
| Oligo       | value | B      | C      | 0.0000000 | 0.0e+00 | 5.3e-12    | \*\*\*\* | T-test |

# References

Hao, Y., Yan, M., Heath, B. R., Lei, Y. L., & Xie, Y. (2019). Fast and
robust deconvolution of tumor infiltrating lymphocyte from expression
profiles using least trimmed squares. PLoS computational biology, 15(5),
e1006976. <https://doi.org/10.1371/journal.pcbi.1006976>

Chen, B., Khodadoust, M. S., Liu, C. L., Newman, A. M., & Alizadeh, A.
A. (2018). Profiling Tumor Infiltrating Immune Cells with CIBERSORT.
Methods in molecular biology (Clifton, N.J.), 1711, 243–259.
<https://doi.org/10.1007/978-1-4939-7493-1_12>

Racle, J., & Gfeller, D. (2020). EPIC: A Tool to Estimate the
Proportions of Different Cell Types from Bulk Gene Expression Data.
Methods in molecular biology (Clifton, N.J.), 2120, 233–248.
<https://doi.org/10.1007/978-1-0716-0327-7_17>

Avila Cobos, F., Alquicira-Hernandez, J., Powell, J.E. et
al. Benchmarking of cell type deconvolution pipelines for
transcriptomics data. Nat Commun 11, 5650 (2020).
<https://doi.org/10.1038/s41467-020-19015-1>

Gregor Sturm, Francesca Finotello, Florent Petitprez, Jitao David Zhang,
Jan Baumbach, Wolf H Fridman, Markus List, Tatsiana Aneichyk,
Comprehensive evaluation of transcriptome-based cell-type quantification
methods for immuno-oncology, Bioinformatics, Volume 35, Issue 14, July
2019, Pages i436–i445, <https://doi.org/10.1093/bioinformatics/btz363>

Francisco Avila Cobos, Jo Vandesompele, Pieter Mestdagh, Katleen De
Preter, Computational deconvolution of transcriptomics data from mixed
cell populations, Bioinformatics, Volume 34, Issue 11, 01 June 2018,
Pages 1969–1979, <https://doi.org/10.1093/bioinformatics/bty019>

Finotello, F., Trajanoski, Z. Quantifying tumor-infiltrating immune
cells from transcriptomics data. Cancer Immunol Immunother 67, 1031–1040
(2018). <https://doi.org/10.1007/s00262-018-2150-z>

Monaco, G., Lee, B., Xu, W., Mustafah, S., Hwang, Y. Y., Carré, C.,
Burdin, N., Visan, L., Ceccarelli, M., Poidinger, M., Zippelius, A.,
Pedro de Magalhães, J., & Larbi, A. (2019). RNA-Seq Signatures
Normalized by mRNA Abundance Allow Absolute Deconvolution of Human
Immune Cell Types. Cell reports, 26(6), 1627–1640.e7.
<https://doi.org/10.1016/j.celrep.2019.01.041>

Jiebiao Wang, Bernie Devlin, Kathryn Roeder, Using multiple measurements
of tissue to estimate subject- and cell-type-specific gene expression,
Bioinformatics, Volume 36, Issue 3, 1 February 2020, Pages 782–788,
<https://doi.org/10.1093/bioinformatics/btz619>
